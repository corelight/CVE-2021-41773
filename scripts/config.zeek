module CVE_2021_41773;

export{
    global faster_http_entity_data: event(c: connection, is_orig: bool, data: string);
}

redef enum Notice::Type += {
        PATH_TRAVERSAL_IS_VULNERABLE,
    };

redef record HTTP::Info += {
        CVE_2021_41773_payload_sample: string &default="";
        CVE_2021_41773_original_URI: string  &optional;
        CVE_2021_41773_analyzed_traffic_length: count &optional;
    };

global include_data_in_notice: bool = T;
global vulnerable_version: pattern = /Apache\/2\.4\.(49|50)/i ;
global path_traversal_encoded: pattern = /\.%2e\//i | /\.%%32%65/;    # represents ../
global http_body_analysis_byte_depth = 1000;